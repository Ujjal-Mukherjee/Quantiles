Transact = within(Transact, {a=(t1+t2)/2 d=t1-t2})
Transact = within(Transact, {a=(t1+t2)/2
d=t1-t2})
names(Transact)
M2 = lm(time~a+d, Transact)
M4 = lm(time~t1+t2+a+d, Transact)
summry(M4)
summary(M4)
coef(M1)
coefs(M1)
coefficients(M1)
M1 = lm(time~t1+t2, Transact)
coefficients(M1)
coef(M1)
coef(M2)
coef(M3)
M3 = lm(time~t2+d, Transact)
M4 = lm(time~t1+t2+a+d, Transact)
coef(M3)
coef(M4)
head(Transact)
M4 = lm(time~t1+a+t2+d, Transact)
summary(M4)
head(cakes)
m1 = lm(Y~X1+X2+I(X1^2)+I(X2^2)+X1*X2, data=cakes)
summary(m1)
m2 = update(~.*block)
m2 = update(m1, ~.*block)
summary(m2)
m2 = update(m1, ~.+block+X1*block+X2*block)
summary(m2)
names(BGSall
names(BGSall)
names(BGSall)
plot(HT18~HT9, pch=ifelse(Sex==0,1,19), data=BGSall)
legend(c("0","1"))
?legend
legend("topleft",c("0","1"))
legend("topleft",c("0","1"), pch=c(0,1))
legend("topleft",c("0","1"), pch=c(1,19))
legend("topleft",c("0","1"), pch=c(1,19), title="Sex")
m.add = lm(NT18~HT9+Sex, BGSall)
m.add = lm(HT18~HT9+Sex, BGSall)
m.int = update(m.add, ~.^2)
anova(m.int, m.add)
anova(m.add, m.int)
confint(m.add, "Sex")
coef(m.ad)
coef(m.add)
coefs = coef(m.add)
abline(coefs[1],coefs[2])
abline(coefs[1],coefs[2], lwd=2)
abline(coefs[1]+coefs[3],coefs[2], lty=2, lwd=2)
abline(coefs[1],coefs[2], lty=2, lwd=2)
abline(coefs[1]+coefs[3],coefs[2], lwd=2)
plot(HT18~HT9, pch=ifelse(Sex==0,1,19), data=BGSall)
legend("topleft",c("0","1"), pch=c(1,19), title="Sex")
# Part 2
m.add = lm(HT18~HT9+Sex, BGSall)
coefs = coef(m.add)
abline(coefs[1],coefs[2], lty=2, lwd=2)
abline(coefs[1]+coefs[3],coefs[2], lwd=2)
legend("topleft",c("   0","   1"), pch=c(1,19), title="Sex")
names(BGSall)
# Part 1
plot(HT18~HT9, pch=ifelse(Sex==0,1,19), data=BGSall)
legend("topleft",c("   0","   1"), pch=c(1,19), title="Sex")
# Part 2
m.add = lm(HT18~HT9+Sex, BGSall)
coefs = coef(m.add)
abline(coefs[1],coefs[2], lty=2, lwd=2)
abline(coefs[1]+coefs[3],coefs[2], lwd=2)
m.int = update(m.add, ~.^2)
anova(m.add, m.int)
# Part 3
confint(m.add, "Sex")
legend("topleft",c("Male","Female"), pch=c(1,19), title="Sex")
plot(HT18~HT9, pch=ifelse(Sex==0,1,19), data=BGSall)
legend("topleft",c("Male","Female"), pch=c(1,19), title="Sex")
x=rnorm(X)
x=rnorm(500)
2+3*x+2*rnorm(500)
y=2+3*x+2*rnorm(500)
X=cbind(x,y)
cov(X)
plot(y~x)
abline(eigen(cov(X))$vectors[,1])
abline(eigen(cov(X))$vectors[,2])
head(UN11)
library(alr4)
head(UN11)
logppgdp = log(UN11$ppgdp)
data32 = data.frame(with(UN11,
cbind(fertility, logppgdp, pctUrban)))
pairs(data32)
plot(as.matrix(data32))
pairs(data32)
m1 = lm(fertility~logppgdp, data=data32)
m2 = lm(fertility~pctUrban, data=data32)
summary(m1)
summary(m2)
mab = lm(logppgdp~pctUrban, data=data32)
mba = lm(pctUrban~logppgdp, data=data32)
plot(residuals(m2)~residuals(mab)) # avp for fertility~logppgdp, adj for pctUrban
plot(residuals(m1)~residuals(mba)) # avp for fertility~pctUrban, adj for fertility
m.full = lm(fertility~logppgdp+pctUrban, data=data32)
m.full$coef
m.res2ba = lm(residuals(m2)~residuals(mab))
m.res2ba$coef
two.resids = cbind(residuals(m.full), residuals(m.res2ba))
View(two.resids)
sum(residuals(m.full)!=residuals(m.res2ba))
sum(residuals(m.full)==residuals(m.res2ba))
View(two.resids)
summary(m.full)
summary(m.res2ba)
dim(UN11)
names(Transact)
Transact = within(Transact, {a=(t1+t2)/2
d=t1-t2})
M1 = lm(time~t1+t2, Transact)
M2 = lm(time~a+d, Transact)
M3 = lm(time~t2+d, Transact)
M4 = lm(time~t1+t2+a+d, Transact)
summary(M4)
M4 = lm(time~t1+a+t2+d, Transact)
summary(M4)
coef(M1)
coef(M2)
coef(M3)
coef(M4)
M4 = lm(time~t1+t2+a+d, Transact)
coef(M1)
coef(M2)
coef(M3)
coef(M4)
head(cakes)
cakes
m1 = lm(Y~(X1+X2)^2+I(X1^2)+I(X2^2), data=cakes)
summary(m1)
m1 = lm(Y~X1+X2+I(X1^2)+I(X2^2)+X1*X2, data=cakes)
summary(m1)
m1 = lm(Y~X1+X2+I(X1^2)+I(X2^2)+X1:X2, data=cakes)
summary(m1)
summary(m1)
m1 = lm(Y ~ (X1+X2)^2+X1^2+X2^2, data=cakes)
summary(m1)
m2 = update(m1, ~.*block)
summary(m2)
m2 = update(m1, ~.+block+X1*block+X2*block)
summary(m2)
m1 = lm(Y ~ (X1+X2)^2+I(X1^2)+I(X2^2), data=cakes)
m2 = update(m1, ~.+block+X1*block+X2*block)
summary(m2)
names(BGSall)
plot(HT18~HT9, data=BGSall)
plot(HT18~HT9,
pch=ifelse(Sex==0,1,19), data=BGSall)
plot(HT18~HT9,
col=ifelse(Sex==0,"red","blue"), data=BGSall)
plot(HT18~HT9,
pch=ifelse(Sex==0,1,19),
col=ifelse(Sex==0,"red","blue"),
data=BGSall)
legend("topleft",c("Male","Female"), pch=c(1,19), title="Sex")
plot(HT18~HT9,
pch=ifelse(Sex==0,1,19),
data=BGSall)
legend("topleft",c("Male","Female"), pch=c(1,19), title="Sex")
m.add = lm(HT18~HT9+Sex, BGSall)
coefs = coef(m.add)
coefs
abline(coefs[1],coefs[2], lty=2, lwd=2)
abline(coefs[1]+coefs[3],coefs[2], lwd=2)
m.int = update(m.add, ~.^2)
coefs(m.int)
coef(m.int)
summary(m.int)
anova(m.add)
anova(m.add, m.int)
plot(HT18~HT9,
pch=ifelse(Sex==0,1,19),
data=BGSall)
coef(m.add)
confint(m.add, "Sex")
confint(m.add)
confint(m.add, c("Sex","HT9"))
library(olive)
library(cepp)
x=olive
x=data(olive)
x
data(olive)
x=olive
x
dim(x)
evaluator.2(x)
trust(ev,parinit=c(median(x[1,]),median(x[2,])),u=c(0.2,0.3),rinit=0.5,rmax=2e5)
class(x)
x=as.matrix(olive)
trust(ev,parinit=c(median(x[1,]),median(x[2,])),u=c(0.2,0.3),rinit=0.5,rmax=2e5)
x <- rnorm(500)
dim(x) <- c(250,2)
ev <- evaluator.2(x)
##The Spatial Median
trust(ev,parinit=c(median(x[1,]),median(x[2,])),u=c(0,0),rinit=0.5,rmax=2e5)
##Quantile for vector (0.2,0.3)
trust(ev,parinit=c(median(x[1,]),median(x[2,])),u=c(0.2,0.3),rinit=0.5,rmax=2e5)
library(alr4)
data(fuel2001)
names(fuel2001)
head(fuel2001)
library(alr3)
head(fuel2001)
detach(alr4)
library("alr3", lib.loc="C:/Study/R/R-3.1.1/library")
library("alr4", lib.loc="C:/Study/R/R-3.1.1/library")
detach("package:alr4", unload=TRUE)
heaD(fuel2001)
head(fuel2001)
ibrary(alr4)
library(alr4)
detach("package:alr4", unload=TRUE)
detach("package:alr3", unload=TRUE)
library(alr4)
detach("package:alr4", unload=TRUE)
head(fuel2001)
?fuel2001
?anova
?Anova
attach(Wool)
len <- as.factor(len)
amp <- as.factor(amp)
load <- as.factor(load)
lm <- lm(cycles ~ len+amp+load+len:amp+len:load+amp:load)
anova(lm)
attach(Wool)
len <- as.factor(len)
amp <- as.factor(amp)
load <- as.factor(load)
lm <- lm(cycles ~ len+amp+load+len:amp+len:load+amp:load, Wool)
anova(lm)
summary(Wool)
attach(Wool)
len <- as.factor(len)
amp <- as.factor(amp)
load <- as.factor(load)
lm <- lm(log(cycles) ~ len+amp+load+len:amp+len:load+amp:load)
anova(lm)
## Stat 8051 hw 3
library(alr4)
## 6.7
data(fuel2001)
fuel2001$Dlic <- 1000*fuel2001$Drivers/fuel2001$Pop
fuel2001$Fuel <- 1000*fuel2001$FuelC/fuel2001$Pop
fuel2001$Income <- fuel2001$Income/1000
fuel2001$logMiles <- log(fuel2001$Miles,2)
# Part 1
m0 = lm(fuel~Tax+Dlic+Income+logMiles, data=fuel2001)
names(fuel2001)
m0 = lm(Fuel~Tax+Dlic+Income+logMiles, data=fuel2001)
anova(m0)
m1 = lm(Fuel~logMiles+Income+Dlic+Tax, data=fuel2001)
anova(m1)
anova(m0)
anova(m1)
library(alr4)
logppgdp = log(UN11$ppgdp)
data32 = data.frame(with(UN11,
cbind(fertility, logppgdp, pctUrban)))
pairs(data32)
m1 = lm(fertility~logppgdp, data=data32)
m2 = lm(fertility~pctUrban, data=data32)
summary(m1)
summary(m2)
mab = lm(logppgdp~pctUrban, data=data32)
mba = lm(pctUrban~logppgdp, data=data32)
plot(residuals(m2)~residuals(mab)) # avp for fertility~logppgdp, adj for pctUrban
plot(residuals(m1)~residuals(mba)) # avp for fertility~pctUrban, adj for fertility
mab = lm(logppgdp~pctUrban, data=data32)
mba = lm(pctUrban~logppgdp, data=data32)
par(mfrow=c(1,2))
plot(residuals(m2)~residuals(mab)) # avp for fertility~logppgdp, adj for pctUrban
plot(residuals(m1)~residuals(mba)) # avp for fertility~pctUrban, adj for fertility
par(mfrow=c(1,1))
plot(residuals(m2)~residuals(mab), pch=19, cex=.8) # avp for fertility~logppgdp, adj for pctUrban
mab = lm(logppgdp~pctUrban, data=data32)
mba = lm(pctUrban~logppgdp, data=data32)
par(mfrow=c(1,2))
plot(residuals(m2)~residuals(mab), pch=19, cex=.8) # avp for fertility~logppgdp, adj for pctUrban
plot(residuals(m1)~residuals(mba), pch=19, cex=.8) # avp for fertility~pctUrban, adj for fertility
par(mfrow=c(1,1))
m.full = lm(fertility~logppgdp+pctUrban, data=data32)
m.full$coef
summary(m.full)
m.full$names
names(m.full)
m.full = lm(fertility~logppgdp+pctUrban, data=data32)
summary(m.full)
m.res2ba = lm(residuals(m2)~residuals(mab))
m.res2ba$coef
two.resids = cbind(residuals(m.full), residuals(m.res2ba))
head(two.resids)
names(Transact)
Transact = within(Transact, {a=(t1+t2)/2
d=t1-t2})
M1 = lm(time~t1+t2, Transact)
M2 = lm(time~a+d, Transact)
M3 = lm(time~t2+d, Transact)
M4 = lm(time~t1+t2+a+d, Transact)
coefs(M4)
coef(M4)
coef(M1)
coef(M2)
coef(M3)
coef(M4)
summary(m.full)
summary(m.res2ba)
?lm
?boxcox
library(alr4)
?boxcox
x=c(1,2,3,4)
y=c(3,4,5,1)
p=boxcox(y~x)
?boxcox
p=boxcox(lm(y~x))
library(MASS)
p=boxcox(lm(y~x))
names(p)
boxcox$x[which.max(boxcox$y)]
p$x[which.max(p$y)]
B=matrix(c(2,3,4,5),2,2)
B
B-colmeans(B)
B-colMeans(B)
B
mean(B)
?vcov
?cov
x=matrix(1:10, ncol=2)
x
cov(x)
var(x[,1])
var(x[,2])
cov(x[,1],x[,2])
x1=x-rowMeans(x)
var(x1[,1])
x1=x-colMeans(x)
x1
cov(x1)
x
rowMeans(x[,1])
rowMeans(x)
?powerTransform
?lm
names(fuel2001)
library(alr4)
names(fuel2001)
anova(m0)
m0 = lm(Fuel~Tax+Dlic+Income+logMiles, data=fuel2001)
m1 = lm(Fuel~logMiles+Income+Dlic+Tax, data=fuel2001)
data(fuel2001)
fuel2001$Dlic <- 1000*fuel2001$Drivers/fuel2001$Pop
fuel2001$Fuel <- 1000*fuel2001$FuelC/fuel2001$Pop
fuel2001$Income <- fuel2001$Income/1000
fuel2001$logMiles <- log(fuel2001$Miles,2)
m0 = lm(Fuel~Tax+Dlic+Income+logMiles, data=fuel2001)
m1 = lm(Fuel~logMiles+Income+Dlic+Tax, data=fuel2001)
anova(m0)
anova(m1)
Anova(m0, type=2)
Anova(m1, type=2)
m1 <- lm(Y ~ X1 + I(X1^2) + X2 + I(X2^2) + X1:X2, cakes)
summary(m1)
m1 <- lm(Y ~ X1 + I(X1^2) + X2 + I(X2^2) + X1:X2, cakes)
m2 <- update(m1, ~ . - X1:X2)
anova(m2, m1)
anova(m3, m1)
m3 <- update(m1, ~ . - I(X1^2))
anova(m3, m1)
m4 <- update(m1, ~ . - X1 - I(X1^2) - X1:X2)
anova(m4, m1)
A = lm(log(acrePrice)~year, data=MinnLand)
summary(A)
Minnland$year
MinnLand$year
MinnLand$year[1:10]
class(MinnLand$year[1:10])
factor(MinnLand$year[1:10])
x=1:10
class(x)
factor(x)
x=1.1:10
x=seq(1,.1,2)
?seq
x=seq(1,2,.1)
x
factor(x)
B = lm(log(acrePrice)~1+fyear, data=MinnLand)
MinnLand$fyear = factor(paste(MinnLand$year))
B = lm(log(acrePrice)~1+fyear, data=MinnLand)
B = lm(log(acrePrice)~fyear, data=MinnLand)
summary(B)
B = lm(log(acrePrice)~1+fyear, data=MinnLand)
summary(B)
anova(A,B)
library(alr3)
pureErrorAnova(A)
library(MASS)
boxcox(lm(Distance~Speed, data=stopping))
names(z)
z = boxcox(lm(Distance~Speed, data=stopping))
names(z)
z$x[which.max(z.y)]
z$x[which.max(z$y)]
invResPlot(lm(Distance~Speed, data=stopping))
par(mfrow=c(1,3))
plot(Distance~1/Speed, stopping)
plot(Distance~log(Speed), stopping)
plot(Distance~Speed, stopping)
par(mfrow=c(1,1))
plot(Distance~Speed^2, stopping)
reg1 = lm(Distance~Speed+I(Speed^2),
weight=Speed^2, data=stopping)
reg2 = lm(Distance^.5~Speed, data=stopping)
plot(Distance~Speed, data=stopping)
lines(fitted.values(reg1)~stopping$Speed,
type = "l",col = "blue")
lines((fitted.values(reg2))^2~stopping$Speed,
type = "l",col = "red")
reg1 = lm(Distance~Speed+I(Speed^2),
weight=1/Speed^2, data=stopping)
plot(Distance~Speed, data=stopping)
lines(fitted.values(reg1)~stopping$Speed,
type = "l",col = "blue")
Fuel = c(514.279, 374.164, 426.349, 842.792, 317.492)
ehat = c(-163.145, -137.599, -102.409, -183.499, -49.452)
h = c(.256, .162, .206, .084, .415)
sighat = 64.891
n = 51; p1 = 5
r = ehat/(sighat*sqrt(1-h))
t = r*sqrt((n-p1-1)/(n-p1-r^2))
D = r^2*h/(p1*(1-h))
d = (data.frame(cbind(r,t,D),
row.names = c("Alaska", "NY", "Hawaii", "Wyoming", "Dist. Col")))
pmin(n*2*pt(-abs(t),46),1)
rm(list=ls());
library(inline)
library(Rcpp)
library(RcppArmadillo)
library(RcppEigen)
sourceCpp("DataDepth.cpp", verbose=TRUE, rebuild=FALSE);
sourceCpp("ProjQuant.cpp", verbose=TRUE, rebuild=FALSE);
setwd("C:/Study/My projects/Quantiles/Codes")
rm(list=ls());
library(inline)
library(Rcpp)
library(RcppArmadillo)
library(RcppEigen)
sourceCpp("DataDepth.cpp", verbose=TRUE, rebuild=FALSE);
sourceCpp("ProjQuantile.cpp", verbose=TRUE, rebuild=FALSE);
rm(list=ls())
set.seed(123)
n<-1000;
library(inline)
library(Rcpp)
library(RcppArmadillo)
library(RcppEigen)
sourceCpp("DataDepth.cpp", verbose=TRUE, rebuild=FALSE);
#x1<-rnorm(n,0,1);
#x2<-rnorm(n,0,5);
#d<-cbind(x1,x2);
x1<-rnorm(n,0,10);
x1<-x1+min(x1)*0.5;
x2<-rnorm(n,0,6);
th<-pi/4;
r=function(th)return(cbind(c(cos(th),sin(th)),c(-sin(th),cos(th))));
dat<-cbind(x1,x2);
dat45<-dat%*%r(th);
th<-3*pi/4;
dat135<-dat%*%r(th);
d<-rbind(dat45,dat135);
d<-apply(d,2,FUN=function(x){return((x-mean(x))/max(x))});
x<-c(0,0);
e<-c(0,0);
p<-QuadrantFrac(d,x,e);
print(p);
q<-ecdf(d,x);
print(q);
k<-100;
x3<-seq(min(d[,1]), max(d[,1]),length.out=k);
x4<-seq(min(d[,2]), max(d[,2]),length.out=k);
xx<-expand.grid(x=x3,y=x4);
xx<-as.matrix(xx);
z<-ecdfGrid(d,xx);
y<-matrix(nrow=k, ncol=k);
for(i in 1:k){
for(j in 1:k){
x<-c(x3[i],x4[j]);
y[i,j]<-ecdf(d,x);
}
}
res<-persp(x3, x4, y, theta=-45, phi=45, shade=TRUE, col=5);
p<-c(0,0);
dep<-depthx(d,p);
med<-medianp(d);
library(scatterplot3d)
library(rgl)
dep1<-DepthGrid(d);
scatterplot3d(d[,1],d[,2],dep1, pch=".", highlight.3d=TRUE)
plot3d(d[,1], d[,2], dep1, col="red", size=3);
